# 打包应用测试指南

## 问题诊断步骤

### 1. 启用调试模式

打包后的应用可以通过以下方式启用调试模式：

#### 方法1：使用调试脚本
```bash
# 给脚本添加执行权限
chmod +x debug-app.sh

# 运行调试脚本
./debug-app.sh
```

#### 方法2：手动启动调试模式
```bash
# 如果应用安装在Applications目录
"/Applications/More Translator.app/Contents/MacOS/More Translator" --debug

# 如果应用在dist目录
"./dist/mac/More Translator.app/Contents/MacOS/More Translator" --debug
```

#### 方法3：使用菜单栏
1. 启动应用
2. 在菜单栏选择 "调试" -> "显示开发者工具"
3. 或使用快捷键 `Cmd+Shift+I`

### 2. 查看控制台日志

启用调试模式后：
1. 开发者工具会自动打开
2. 切换到 "Console" 标签页
3. 尝试触发翻译功能
4. 观察控制台输出

### 3. 常见问题检查

#### 配置文件问题
查看控制台中的配置调试信息：
- 检查 "配置对象存在" 是否为 true
- 检查 API 密钥是否正确加载
- 检查翻译服务列表是否正确

#### 网络连接问题
查看控制台中的网络连接检查：
- 如果网络连接异常，检查防火墙设置
- 检查是否有代理设置影响

#### 文件路径问题
查看控制台中的路径信息：
- 当前工作目录
- 应用路径
- 用户数据目录
- 是否为打包应用

### 4. 对比开发环境

同时运行开发环境和打包环境：

```bash
# 终端1：运行开发环境
npm start

# 终端2：运行打包环境调试模式
./debug-app.sh
```

对比两个环境的控制台输出，找出差异。

### 5. 常见解决方案

#### 问题1：配置文件未加载
- 确保 .env 文件被正确打包
- 检查 package.json 中的 files 配置
- 重新打包应用

#### 问题2：API密钥丢失
- 使用设置界面重新配置API密钥
- 检查用户数据目录中的配置文件

#### 问题3：网络请求失败
- 检查防火墙设置
- 检查代理配置
- 尝试使用不同的翻译服务

#### 问题4：权限问题
- 检查辅助功能权限
- 重新授权应用

### 6. 收集调试信息

如果问题仍然存在，请收集以下信息：
1. 控制台完整日志
2. 系统版本信息
3. 应用版本信息
4. 错误复现步骤

## 重新打包

如果发现配置问题，修复后重新打包：

```bash
# 清理旧的打包文件
rm -rf dist/

# 重新打包
npm run build-mac
```

## 测试清单

- [ ] 应用能正常启动
- [ ] 快捷键能触发翻译按钮
- [ ] 翻译按钮能正常显示
- [ ] 能复制选中文本
- [ ] 翻译功能正常工作
- [ ] 设置界面能正常打开
- [ ] API配置能正常保存
- [ ] 调试模式能正常工作 